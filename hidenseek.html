<!DOCTYPE html>
<html>
<head>
    <title>Hide and Seek</title>
    <style>
        body {
            background-color: #f9f9f9; /* Light background */
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            flex-direction: column;
            font-family: 'Arial Rounded MT Bold', 'Helvetica Rounded', Arial, sans-serif; /* Rounded, playful font */
            color: #444;
        }
        .grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 5px;
            width: 90%; /* Use more of the screen's width */
            padding: 20px;
            box-sizing: border-box;
        }
        .cell {
            height: 0;
            padding-bottom: 20%; /* Maintain square aspect ratio */
            border: 2px solid #000;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            user-select: none;
            font-size: 2em; /* Larger emojis */
            color: #444;
            transition: background-color 0.2s, transform 0.2s; /* Animated background color and "pop" */
            border-radius: 10px; /* Rounded corners */
        }
        .cell:active {
            transform: scale(0.95); /* "Pop" effect on click */
        }
        .scoreboard {
            font-size: 24px;
            padding: 10px;
            width: 90%;
            max-width: 500px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #fff;
            box-shadow: 0px 0px 10px rgba(0,0,0,0.1);
            border-radius: 10px; /* Rounded corners */
            margin-bottom: 20px;
        }
        #reset {
            background-color: #f44336; /* Red */
            color: white;
            border: none;
            padding: 10px 20px; /* Larger button */
            font-size: 1.2em; /* Larger button text */
            border-radius: 5px;
            cursor: pointer;
            outline: none;
            box-shadow: 0px 0px 10px rgba(0,0,0,0.1);
        }
        .modal {
            display: none; /* Hidden by default */
            position: fixed; /* Stay in place */
            z-index: 1; /* Sit on top */
            padding-top: 100px; /* Location of the box */
            left: 0;
            top: 0;
            width: 100%; /* Full width */
            height: 100%; /* Full height */
            overflow: auto; /* Enable scroll if needed */
            background-color: rgb(0,0,0); /* Fallback color */
            background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
        }
        .modal-content {
            background-color: #fefefe;
            margin: auto;
            padding: 20px;
            border: 1px solid #888;
            width: 80%;
            max-width: 500px;
            box-shadow: 0px 0px 10px rgba(0,0,0,0.1);
            border-radius: 5px;
        }
        @media (min-width: 600px) {
            .grid, .scoreboard {
                width: 80%;
                max-width: 600px;
            }
        }
    </style>
</head>
<body>
    <div id="myModal" class="modal">
        <div class="modal-content">
            <h2>Welcome to Hide and Seek!</h2>
            <p>In this game, you will have to find the hidden cell. The cell will change its color based on how close you are to the hidden cell. The color goes from red (very close) to blue (very far).</p>
            <p>Each time you click a cell, your score decreases. Your aim is to find the hidden cell with the highest score possible.</p>
            <p>Click anywhere outside this box to close it and start playing!</p>
        </div>
    </div>
    <div id="scoreboard" class="scoreboard">
        <div id="score"></div>
        <button id="reset">Reset</button>
    </div>
    <div id="grid" class="grid"></div>

    <script>
        const gridSize = 25;
        let hiddenCell = Math.floor(Math.random() * gridSize);
        let score = gridSize; // Start score at gridSize (25)
        let totalScore = 0; // Cumulative score
        let rounds = 0; // Number of rounds played
        const grid = document.getElementById('grid');
        const scoreElement = document.getElementById('score');
        const resetButton = document.getElementById('reset');

        scoreElement.textContent = `Round: ${rounds}, Score: ${totalScore}, Next round in: 0`;

        // Calculate distance between two cells
        function distance(cell1, cell2) {
            let x1 = cell1 % 5;
            let y1 = Math.floor(cell1 / 5);
            let x2 = cell2 % 5;
            let y2 = Math.floor(cell2 / 5);

            return Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));
        }

        // Calculate color based on distance
        function getColor(dist) {
            // Normalize the distance (0 to 1)
            let normalizedDist = dist / Math.sqrt(50); // max distance in a 5x5 grid
            
            let r = Math.floor((1 - normalizedDist) * 255); // Red decreases with normalized distance
            let g = 0; // Green is always 0
            let b = Math.floor(normalizedDist * 255); // Blue increases with normalized distance

            return 'rgb(' + r + ',' + g + ',' + b + ')';
        }

        // Get emoji based on distance
        function getEmoji(dist) {
            if (dist < 1) return "üî•"; // Fire
            else if (dist < 2) return "ü•µ"; // Hot
            else if (dist < 3) return "ü•µ"; // Warm
            else if (dist < 4) return "üßä"; // Frozen
            else if (dist < 5) return "‚ùÑÔ∏è"; // Cold
            else return "üßä"; // Cool
        }

        function resetGame() {
            // Don't reset the game if it's already resetting
            if (grid.classList.contains('resetting')) {
                return;
            }

            grid.classList.add('resetting');

            let countdown = 5;
            const countdownInterval = setInterval(() => {
                countdown--;
                scoreElement.textContent = `Round: ${rounds}, Score: ${totalScore}, Next round in: ${countdown}`;
                if (countdown === 0) {
                    clearInterval(countdownInterval);
                    hiddenCell = Math.floor(Math.random() * gridSize);
                    score = gridSize;
                    // Remove all cells from the grid
                    while (grid.firstChild) {
                        grid.removeChild(grid.firstChild);
                    }
                    // Recreate the grid
                    for(let i = 0; i < gridSize; i++) {
                        const cell = document.createElement('div');
                        cell.className = 'cell';
                        cell.textContent = ''; // Don't show numbers
                        cell.addEventListener('click', () => {
                            score--; // Decrease score with each guess
                            let dist = distance(i, hiddenCell);
                            cell.style.backgroundColor = getColor(dist);
                            if(i === hiddenCell) {
                                totalScore += score;
                                rounds++;
                                cell.textContent = "üèÜ"; // Trophy for winning cell
                                resetGame();
                            } else {
                                cell.textContent = getEmoji(dist);
                            }
                            cell.removeEventListener('click', arguments.callee);
                        });

                        grid.appendChild(cell);
                    }
                    scoreElement.textContent = `Round: ${rounds}, Score: ${totalScore}, Next round in: 0`;
                    grid.classList.remove('resetting');
                }
            }, 1000);
        }

        function restartGame() {
            totalScore = 0;
            rounds = 0;
            resetGame();
        }

        for(let i = 0; i < gridSize; i++) {
            const cell = document.createElement('div');
            cell.className = 'cell';
            cell.textContent = ''; // Don't show numbers
            cell.addEventListener('click', () => {
                score--; // Decrease score with each guess
                let dist = distance(i, hiddenCell);
                cell.style.backgroundColor = getColor(dist);
                if(i === hiddenCell) {
                    totalScore += score;
                    rounds++;
                    cell.textContent = "üèÜ"; // Trophy for winning cell
                    resetGame();
                } else {
                    cell.textContent = getEmoji(dist);
                }
                cell.removeEventListener('click', arguments.callee);
            });

            grid.appendChild(cell);
        }

        resetButton.addEventListener('click', restartGame);

        // Show the instructions modal on first load
        const modal = document.getElementById('myModal');
        modal.style.display = "block";
        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
            if (event.target === modal) {
                modal.style.display = "none";
            }
        }
    </script>
</body>
</html>
